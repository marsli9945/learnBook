# ga改版技术方案

## 系统组成

系统架构采用前后端分离的开发流程，加入中间层提供http之外的额外功能，以及对后端服务的对外封装，同时提供用户登录和权限模块功能，让后端服务开发只需关注业务逻辑。

类型|技术栈|功能
--|:--:|--:
客户端|vue、element-ui|客户端页面展示
中间层|php、swoole|服务的渲染、websocket服务、用户及权限校验
服务端|spring-cloud、spring-boot|数据核心功能服务

### 1、前端
前端使用vue框架以及配套的vuex和vue-router组件，实现前端路由跳转以及前端缓存等相关功能，接口请求使用axios组件，数据格式统一使用json格式。页面渲染搭配使用element-ui完成页面基础组件的实现，可以灵活美观的构建所需要的复杂页面需求。

### 2、中间层
中间层主要负责进行服务端渲染，建立服务端和前端交互的桥梁，屏蔽了中间的复杂性和反复校验环节。利用php+swoole实现websocket长连接，为前后端的交互提供http以外的额外功能，实现页面交互的异步刷新和后端消息主动推送功能。

### 3、服务端
spring-cloud实现的微服务集群，由后端开发者提供整个系统核心的服务部分，完成核心的数据服务部分。

## 改进方案

### 1、梳理现有代码，合理压缩代码组成
现有代码所有组件全量加载，代码冗余过高，打包和启动时间太长。所以应重新组织代码，精简组件加速代码执行效率。

### 2、解除用户登录状态与socket长连接的请相关状态
由于websocket连接时长和状态受影响因素太多，连接不稳定因此与用户登录状态进行强相关体验太差。改进方案：取消websocke与用户登录状态的强相关，连接断开进行重连，保障用户使用过程中长连接持久在线。

### 3、重新定义用户权限管理模式
按文档重构

### 4、中间层对于数据转发不再进行侵入式重组
PHP对于json数据有偏差，因此从前端接收数据不再进行重新拆解和转化，中间层额外数据与前端传递数据分开传递。
